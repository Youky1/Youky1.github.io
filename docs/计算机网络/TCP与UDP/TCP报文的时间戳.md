---
category: 计算机网络
tag:
    - TCP
---

# TCP报文的时间戳

作用有两个：
1. 计算往返时间RTT
2. 防止序列号回绕

## 计算RTT

以a向b发送为例
1. a发送的报文1中，`timestamp`字段存放的是发送时的时间`timeA`
2. b向a回复的报文2中，`timestamp`字段存放的是发送时的时间`timeB`，`timestamp echo`字段存放的是`timeA`
3. a收到报文2时，时间为`timeA'`，再从报文中读取`timeA`，即可计算RTT

## 防止序列号回绕

序列号`Sequence Number`是0~2^31-1范围内循环的，即达到最大值后从0重新开始循环。

序列号用于确认报文的顺序，以便按正确的顺序进行组装。若出现回绕，则会造成疑惑。

而通过时间戳，则可以分辨不同数据包发送的先后顺序。